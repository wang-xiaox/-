{"ast":null,"code":"import { mixin } from \"../../../minix\";\nimport { getUser, setUserInfo, setUserAvatar } from '../../../api/api';\nexport default {\n  mixins: [mixin],\n  data() {\n    var checkPhone = (rule, value, callback) => {\n      if (!value) {\n        return callback(new Error('请输入联系电话'));\n      } else {\n        const reg = /^1[3|4|5|7|8][0-9]\\d{8}$/;\n        if (reg.test(value)) {\n          callback();\n        } else {\n          return callback(new Error('请输入正确的联系电话'));\n        }\n      }\n    };\n    return {\n      user: {\n        avatar: \"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fsafe-img.xhscdn.com%2Fbw1%2Fb4a87154-18b6-4163-ac80-f4dc4bf58d09%3FimageView2%2F2%2Fw%2F1080%2Fformat%2Fjpg&refer=http%3A%2F%2Fsafe-img.xhscdn.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1693364028&t=c518c6c4a6ee2009b961f712a57c211f\"\n      },\n      avatar: [\"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fsafe-img.xhscdn.com%2Fbw1%2Fb4a87154-18b6-4163-ac80-f4dc4bf58d09%3FimageView2%2F2%2Fw%2F1080%2Fformat%2Fjpg&refer=http%3A%2F%2Fsafe-img.xhscdn.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1693364028&t=c518c6c4a6ee2009b961f712a57c211f\"],\n      rules: {\n        userName: [{\n          required: true,\n          message: '请输入用户名',\n          trigger: 'blur'\n        }],\n        email: [{\n          required: true,\n          message: '请输入邮箱地址',\n          trigger: 'blur'\n        }, {\n          type: 'email',\n          message: '请输入正确的邮箱地址',\n          trigger: 'blur'\n        }],\n        tel: [{\n          required: true,\n          validator: checkPhone,\n          message: '请输入正确的联系电话',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  methods: {\n    submit() {\n      this.$refs[\"ruleForm\"].validate(valid => {\n        if (valid) {\n          setUserInfo(this.user).then(res => {\n            if (res.code == 1000) {\n              this.$message({\n                type: 'success',\n                message: '保存成功!'\n              });\n              this.getUserInfo();\n            } else {\n              this.$notify.error({\n                title: '错误',\n                message: res.message\n              });\n            }\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n    getUserInfo() {\n      getUser().then(res => {\n        if (res.code == 1000) {\n          this.user = res.data;\n          this.user.sex = res.data.sex + \"\";\n          this.avatar[0] = this.$store.state.configure.HOST + this.user.avatar;\n          this.setUser();\n        } else {\n          this.$notify.error({\n            title: '错误',\n            message: res.message\n          });\n        }\n      });\n    },\n    setUser() {\n      this.$store.commit('user/setUser', JSON.stringify(this.user));\n    },\n    changePassword() {\n      //修改密码\n      this.$bus.$emit('password', true);\n    },\n    handleAvatorSuccess(res) {\n      let _this = this;\n      if (res.code == 1000) {\n        _this.$message({\n          type: 'success',\n          message: '上传成功!'\n        });\n        this.getUserInfo();\n      } else {\n        _this.$notify.error({\n          title: '错误',\n          message: res.message\n        });\n      }\n    }\n  },\n  created() {},\n  mounted() {\n    this.getUserInfo();\n  }\n};","map":{"version":3,"names":["mixin","getUser","setUserInfo","setUserAvatar","mixins","data","checkPhone","rule","value","callback","Error","reg","test","user","avatar","rules","userName","required","message","trigger","email","type","tel","validator","methods","submit","$refs","validate","valid","then","res","code","$message","getUserInfo","$notify","error","title","sex","$store","state","configure","HOST","setUser","commit","JSON","stringify","changePassword","$bus","$emit","handleAvatorSuccess","_this","created","mounted"],"sources":["src/views/system/center/center.vue"],"sourcesContent":["<template>\r\n  <div class=\"center\">\r\n    <el-card class=\"box-card\">\r\n        <div class=\"content\">\r\n            <div class=\"master\">\r\n              <el-form style=\"margin-right:20px\" :model=\"user\" :rules=\"rules\" ref=\"ruleForm\" label-width=\"140px\">\r\n                <el-form-item label=\"登陆账号\" prop=\"loginAccount\">\r\n                  <el-input size=\"mini\" disabled v-model=\"user.loginAccount\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"用户名\" prop=\"userName\">\r\n                  <el-input size=\"mini\" v-model=\"user.userName\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"邮箱\" prop=\"email\">\r\n                  <el-input size=\"mini\" v-model=\"user.email\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"联系电话\" prop=\"tel\">\r\n                  <el-input size=\"mini\" v-model=\"user.tel\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"性别\" prop=\"tel\">\r\n                  <el-radio-group v-model=\"user.sex\">\r\n                    <el-radio label=\"0\">男</el-radio>\r\n                    <el-radio label=\"1\">女</el-radio>\r\n                  </el-radio-group>\r\n                </el-form-item>\r\n                <el-form-item label=\"登陆IP\" prop=\"loginIp\">\r\n                  <el-input size=\"mini\" disabled v-model=\"user.loginIp\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"登陆时间\" prop=\"loginDate\">\r\n                  <el-input size=\"mini\" disabled v-model=\"user.loginDate\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"上次修改密码时间\" prop=\"pwdUpdateDate\">\r\n                  <el-input size=\"mini\" disabled v-model=\"user.pwdUpdateDate\"></el-input>\r\n                </el-form-item>\r\n              </el-form>\r\n              <div class=\"submit\">\r\n                  <el-button type=\"primary\" plain size=\"mini\" @click=\"submit\">保存</el-button>\r\n              </div>\r\n            </div>\r\n            <div class=\"slave\">\r\n                <div class=\"img\">\r\n                  <el-image \r\n                    style=\"object-fit: cover;width: 300px; height: 300px;overflow: hidden;border-radius: 50%;\"\r\n                    :src=\"$store.state.configure.HOST + user.avatar\" \r\n                    :preview-src-list=\"avatar\">\r\n                  </el-image>\r\n                </div>\r\n                <div class=\"btns\">\r\n                  <div>\r\n                    <el-upload\r\n                      ref=\"upload\"\r\n                      :action=\"uploadAvatarUrl()+ '/'+ this.user.id\"\r\n                      :show-file-list=\"false\"\r\n                      :before-upload=\"beforeAvatorUpload\"\r\n                      :on-success=\"handleAvatorSuccess\"\r\n                      accept=\"image/*\"\r\n                      >\r\n                      <el-button size=\"mini\" icon=\"el-icon-picture-outline-round\">修改头像</el-button>\r\n                    </el-upload>\r\n                  </div>\r\n                  <div style=\"margin-top:15px\">\r\n                    <el-button size=\"mini\" icon=\"el-icon-key\" @click=\"changePassword\">修改密码</el-button>\r\n                  </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import {mixin} from \"../../../minix\";\r\n  import {getUser,setUserInfo,setUserAvatar} from '../../../api/api' \r\n  export default {\r\n    mixins: [mixin],\r\n    data() {\r\n      var checkPhone = (rule, value, callback) => {\r\n          if (!value) {\r\n              return callback(new Error('请输入联系电话'));\r\n          } else {\r\n              const reg = /^1[3|4|5|7|8][0-9]\\d{8}$/\r\n              if (reg.test(value)) {\r\n                  callback();\r\n              } else {\r\n                  return callback(new Error('请输入正确的联系电话'));\r\n              }\r\n          }\r\n      };\r\n      return{\r\n        user: {\r\n          avatar: \"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fsafe-img.xhscdn.com%2Fbw1%2Fb4a87154-18b6-4163-ac80-f4dc4bf58d09%3FimageView2%2F2%2Fw%2F1080%2Fformat%2Fjpg&refer=http%3A%2F%2Fsafe-img.xhscdn.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1693364028&t=c518c6c4a6ee2009b961f712a57c211f\"\r\n        },\r\n        avatar: [\"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fsafe-img.xhscdn.com%2Fbw1%2Fb4a87154-18b6-4163-ac80-f4dc4bf58d09%3FimageView2%2F2%2Fw%2F1080%2Fformat%2Fjpg&refer=http%3A%2F%2Fsafe-img.xhscdn.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1693364028&t=c518c6c4a6ee2009b961f712a57c211f\"],\r\n        rules: {\r\n          userName: [\r\n            { required: true, message: '请输入用户名', trigger: 'blur' },\r\n          ],\r\n          email: [\r\n            { required: true, message: '请输入邮箱地址', trigger: 'blur' },\r\n            { type: 'email', message: '请输入正确的邮箱地址', trigger: 'blur' }\r\n          ],\r\n          tel: [\r\n            { required: true, validator:checkPhone, message: '请输入正确的联系电话', trigger: 'blur' },\r\n          ],\r\n        },\r\n      }\r\n    },\r\n    methods: {\r\n      submit() {\r\n        this.$refs[\"ruleForm\"].validate((valid) => {\r\n          if (valid) {\r\n            setUserInfo(this.user).then(res => {\r\n              if(res.code == 1000) {\r\n                this.$message({\r\n                  type: 'success',\r\n                  message: '保存成功!'\r\n                });\r\n                this.getUserInfo()\r\n              } else {\r\n                this.$notify.error({\r\n                  title: '错误',\r\n                  message: res.message\r\n                });\r\n              }\r\n            })\r\n          } else {\r\n            return false;\r\n          }\r\n        });\r\n      },\r\n      getUserInfo() {\r\n        getUser().then(res => {\r\n            if(res.code == 1000) {\r\n              this.user = res.data\r\n              this.user.sex = res.data.sex + \"\"\r\n              this.avatar[0] = this.$store.state.configure.HOST + this.user.avatar\r\n              this.setUser()\r\n            } else {\r\n              this.$notify.error({\r\n                title: '错误',\r\n                message: res.message\r\n              });\r\n            }\r\n        })\r\n      },\r\n      setUser() {\r\n        this.$store.commit('user/setUser', JSON.stringify(this.user))\r\n      },\r\n      changePassword() {\r\n        //修改密码\r\n        this.$bus.$emit('password', true)\r\n      },\r\n      handleAvatorSuccess(res){\r\n        let _this = this;\r\n        if(res.code == 1000){\r\n            _this.$message({\r\n              type: 'success',\r\n              message: '上传成功!'\r\n            });\r\n            this.getUserInfo()\r\n        }else{\r\n          _this.$notify.error({\r\n            title: '错误',\r\n            message: res.message\r\n          });\r\n        }\r\n      },\r\n    },\r\n    created() {\r\n     \r\n    },\r\n    mounted() {\r\n      this.getUserInfo()\r\n    }\r\n }\r\n</script>\r\n\r\n<style  scoped>\r\n  .content {\r\n      width: 100%;\r\n      height: 550px;\r\n      display: flex;\r\n      flex-direction: row;\r\n      font-family: \"黑体\";\r\n  }\r\n  .master {\r\n      width: 60%;\r\n      border-right: 1px solid #E5E5E5;\r\n  }\r\n  .submit {\r\n    width: 100%;\r\n    text-align: center;\r\n  }\r\n  .slave {\r\n      width: 40%;\r\n  }\r\n  .img {\r\n      width: 100%;\r\n      height: 75%;\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n  }\r\n  .btns {\r\n      width: 100%;\r\n      height: 25%;\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n  }\r\n</style>"],"mappings":"AAsEA,SAAAA,KAAA;AACA,SAAAC,OAAA,EAAAC,WAAA,EAAAC,aAAA;AACA;EACAC,MAAA,GAAAJ,KAAA;EACAK,KAAA;IACA,IAAAC,UAAA,GAAAA,CAAAC,IAAA,EAAAC,KAAA,EAAAC,QAAA;MACA,KAAAD,KAAA;QACA,OAAAC,QAAA,KAAAC,KAAA;MACA;QACA,MAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA,CAAAJ,KAAA;UACAC,QAAA;QACA;UACA,OAAAA,QAAA,KAAAC,KAAA;QACA;MACA;IACA;IACA;MACAG,IAAA;QACAC,MAAA;MACA;MACAA,MAAA;MACAC,KAAA;QACAC,QAAA,GACA;UAAAC,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,EACA;QACAC,KAAA,GACA;UAAAH,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,GACA;UAAAE,IAAA;UAAAH,OAAA;UAAAC,OAAA;QAAA,EACA;QACAG,GAAA,GACA;UAAAL,QAAA;UAAAM,SAAA,EAAAjB,UAAA;UAAAY,OAAA;UAAAC,OAAA;QAAA;MAEA;IACA;EACA;EACAK,OAAA;IACAC,OAAA;MACA,KAAAC,KAAA,aAAAC,QAAA,CAAAC,KAAA;QACA,IAAAA,KAAA;UACA1B,WAAA,MAAAW,IAAA,EAAAgB,IAAA,CAAAC,GAAA;YACA,IAAAA,GAAA,CAAAC,IAAA;cACA,KAAAC,QAAA;gBACAX,IAAA;gBACAH,OAAA;cACA;cACA,KAAAe,WAAA;YACA;cACA,KAAAC,OAAA,CAAAC,KAAA;gBACAC,KAAA;gBACAlB,OAAA,EAAAY,GAAA,CAAAZ;cACA;YACA;UACA;QACA;UACA;QACA;MACA;IACA;IACAe,YAAA;MACAhC,OAAA,GAAA4B,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAlB,IAAA,GAAAiB,GAAA,CAAAzB,IAAA;UACA,KAAAQ,IAAA,CAAAwB,GAAA,GAAAP,GAAA,CAAAzB,IAAA,CAAAgC,GAAA;UACA,KAAAvB,MAAA,WAAAwB,MAAA,CAAAC,KAAA,CAAAC,SAAA,CAAAC,IAAA,QAAA5B,IAAA,CAAAC,MAAA;UACA,KAAA4B,OAAA;QACA;UACA,KAAAR,OAAA,CAAAC,KAAA;YACAC,KAAA;YACAlB,OAAA,EAAAY,GAAA,CAAAZ;UACA;QACA;MACA;IACA;IACAwB,QAAA;MACA,KAAAJ,MAAA,CAAAK,MAAA,iBAAAC,IAAA,CAAAC,SAAA,MAAAhC,IAAA;IACA;IACAiC,eAAA;MACA;MACA,KAAAC,IAAA,CAAAC,KAAA;IACA;IACAC,oBAAAnB,GAAA;MACA,IAAAoB,KAAA;MACA,IAAApB,GAAA,CAAAC,IAAA;QACAmB,KAAA,CAAAlB,QAAA;UACAX,IAAA;UACAH,OAAA;QACA;QACA,KAAAe,WAAA;MACA;QACAiB,KAAA,CAAAhB,OAAA,CAAAC,KAAA;UACAC,KAAA;UACAlB,OAAA,EAAAY,GAAA,CAAAZ;QACA;MACA;IACA;EACA;EACAiC,QAAA,GAEA;EACAC,QAAA;IACA,KAAAnB,WAAA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}