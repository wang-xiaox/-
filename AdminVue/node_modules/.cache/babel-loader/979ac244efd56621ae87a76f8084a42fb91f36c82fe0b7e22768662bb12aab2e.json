{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { getMenuByUser } from '@/api/api';\nconst state = {\n  activeMenuArrary: [{\n    \"name\": \"首页\",\n    \"url\": \"/index\"\n  }],\n  activeMenu: \"/index\",\n  menus: [],\n  routes: [],\n  displayMenus: [],\n  btnMenus: []\n};\nconst getters = {\n  getMenu(state) {\n    return state.menus;\n  },\n  getRoutes(state) {\n    return state.routes;\n  },\n  getDisplayMenus(state) {\n    return state.displayMenus;\n  },\n  getBtnMenus(state) {\n    return state.btnMenus;\n  }\n};\nconst mutations = {\n  setActiveMenu(state, menu) {\n    state.activeMenu = menu;\n  },\n  addActiveMenu(state, menu) {\n    state.activeMenuArrary.push(menu);\n  },\n  reduceActiveMenu(state, i) {\n    state.activeMenuArrary.splice(i, 1);\n  },\n  setMenus(state, menus) {\n    state.menus = menus;\n  },\n  setRoutes(state, routes) {\n    state.routes = routes;\n  },\n  setDisplayMenus(state, menus) {\n    state.displayMenus = menus;\n  },\n  setBtnMenus(state, btn) {\n    state.btnMenus = btn;\n  }\n};\nconst actions = {\n  generateRoutes({\n    commit\n  }) {\n    return new Promise(resolve => {\n      //根据用户获取菜单权限\n      getMenuByUser().then(res => {\n        if (res.code == 1000) {\n          var data = res.data;\n          commit(\"setMenus\", data);\n          //开始组装路由信息\n          var routes = filterRoutes(data);\n          routes.push({\n            path: '*',\n            redirect: '/404'\n          });\n          commit(\"menu/setRoutes\", routes);\n          //遍历获取首页左侧菜单\n          var display = filterMenus(data);\n          commit(\"menu/displayMenus\", display);\n          //遍历获取按钮权限\n          var btnMenus = filterBtnMenus(data);\n          commit(\"menu/setBtnMenus\", btnMenus);\n          resolve(routes);\n        }\n      });\n    });\n  }\n};\nfunction filterBtnMenus(menus) {\n  var menu = [];\n  menus.forEach(item => {\n    if (item.menuType == 2) {\n      menu.push(item);\n    }\n  });\n  return menu;\n}\nfunction filterMenus(menus) {\n  var menu = [];\n  menus.forEach(item => {\n    //遍历一级菜单或目录\n    if (item.menuType != 2 && item.visible == 0 && !item.parents) {\n      //一级菜单去找自己的下级\n      item.child = [];\n      if (item.menuType == 0) {\n        filterChildMenus(item, menus);\n      }\n      menu.push(item);\n    }\n  });\n}\nfunction filterChildMenus(menu, menus) {\n  menu.child = [];\n  menus.forEach(item => {\n    if (menu.id == item.parentId) {\n      if (item.menuType == 0) {\n        filterChildMenus(item, menus);\n        menu.child.push(item);\n      } else if (item.menuType == 1) {\n        menu.child.push(item);\n      }\n    }\n  });\n}\nfunction filterRoutes(menus) {\n  var routes = [];\n  var root = {\n    path: \"\",\n    name: 'main',\n    component: () => import(`@/views/layout/index`),\n    redirect: '',\n    children: []\n  };\n  var children = [];\n  //遍历出路由\n  menus.forEach(item => {\n    //把菜单先遍历出来\n    if (item.menuType == 1) {\n      var param = {\n        path: item.routeUrl,\n        name: item.menuName,\n        component: loadView(item.componentUrl),\n        props: JSON.stringify(item.param)\n      };\n      if (item.target == 1) {\n        children.push(param);\n      }\n      if (item.target == 0) {\n        routes.push(param);\n      }\n    }\n  });\n  root.children = children;\n  if (children.length > 0) {\n    root.redirect = children[0].routeUrl;\n  }\n  routes.push(root);\n  return routes;\n}\nfunction loadView(view) {\n  if (process.env.NODE_ENV === 'development') {\n    return resolve => require([`@/views${view}`], resolve);\n  } else {\n    // 使用 import 实现生产环境的路由懒加载\n    return () => import(`@/views${view}`);\n  }\n}\nexport default {\n  namespaced: true,\n  state,\n  getters,\n  mutations,\n  actions\n};","map":{"version":3,"names":["getMenuByUser","state","activeMenuArrary","activeMenu","menus","routes","displayMenus","btnMenus","getters","getMenu","getRoutes","getDisplayMenus","getBtnMenus","mutations","setActiveMenu","menu","addActiveMenu","push","reduceActiveMenu","i","splice","setMenus","setRoutes","setDisplayMenus","setBtnMenus","btn","actions","generateRoutes","commit","Promise","resolve","then","res","code","data","filterRoutes","path","redirect","display","filterMenus","filterBtnMenus","forEach","item","menuType","visible","parents","child","filterChildMenus","id","parentId","root","name","component","children","param","routeUrl","menuName","loadView","componentUrl","props","JSON","stringify","target","length","view","process","env","NODE_ENV","require","namespaced"],"sources":["D:/vue_project/back_stage_front/src/store/modules/menu.js"],"sourcesContent":["import { getMenuByUser } from '@/api/api'\r\nconst state = {\r\n  activeMenuArrary: [\r\n    {\r\n      \"name\": \"首页\",\r\n      \"url\": \"/index\"\r\n    }\r\n  ],\r\n  activeMenu: \"/index\",\r\n  menus: [],\r\n  routes: [],\r\n  displayMenus: [],\r\n  btnMenus: []\r\n}\r\n\r\nconst getters ={\r\n  getMenu(state) {\r\n    return state.menus\r\n  },\r\n  getRoutes(state) {\r\n    return state.routes\r\n  },\r\n  getDisplayMenus(state) {\r\n    return state.displayMenus\r\n  },\r\n  getBtnMenus(state) {\r\n    return state.btnMenus\r\n  }\r\n}\r\n\r\nconst mutations = {\r\n  setActiveMenu(state,menu) {\r\n      state.activeMenu = menu\r\n  },\r\n  addActiveMenu(state,menu) {\r\n      state.activeMenuArrary.push(menu)\r\n  },\r\n  reduceActiveMenu(state,i) {\r\n      state.activeMenuArrary.splice(i,1)\r\n  },\r\n  setMenus(state,menus) {\r\n      state.menus = menus\r\n  },\r\n  setRoutes(state,routes) {\r\n    state.routes = routes\r\n  },\r\n  setDisplayMenus(state,menus) {\r\n    state.displayMenus = menus\r\n  },\r\n  setBtnMenus(state,btn) {\r\n    state.btnMenus = btn\r\n  }\r\n}\r\n\r\nconst actions = {\r\n  generateRoutes({ commit }) {\r\n    return new Promise(resolve => {\r\n      //根据用户获取菜单权限\r\n      getMenuByUser().then(res => {\r\n        if(res.code == 1000) {\r\n          var data = res.data\r\n          commit(\"setMenus\",data)\r\n          //开始组装路由信息\r\n          var routes = filterRoutes(data)\r\n          routes.push({ path: '*', redirect: '/404'})\r\n          commit(\"menu/setRoutes\",routes)\r\n          //遍历获取首页左侧菜单\r\n          var display = filterMenus(data)\r\n          commit(\"menu/displayMenus\",display)\r\n          //遍历获取按钮权限\r\n          var btnMenus = filterBtnMenus(data)\r\n          commit(\"menu/setBtnMenus\",btnMenus)\r\n          resolve(routes)\r\n        }\r\n      })\r\n    })\r\n  }\r\n}\r\n\r\nfunction filterBtnMenus(menus) {\r\n  var menu = []\r\n  menus.forEach(item => {\r\n    if(item.menuType == 2) {\r\n      menu.push(item)\r\n    }\r\n  })\r\n  return menu\r\n}\r\n\r\nfunction filterMenus(menus) {\r\n  var menu = []\r\n  menus.forEach(item => {\r\n    //遍历一级菜单或目录\r\n    if(item.menuType != 2 && item.visible == 0 && !item.parents) {\r\n      //一级菜单去找自己的下级\r\n      item.child = []\r\n      if(item.menuType == 0) {\r\n        filterChildMenus(item,menus)\r\n      }\r\n      menu.push(item)\r\n    }\r\n  })\r\n}\r\n\r\nfunction filterChildMenus(menu,menus) {\r\n  menu.child = []\r\n  menus.forEach(item => {\r\n    if(menu.id == item.parentId) {\r\n      if(item.menuType == 0) {\r\n        filterChildMenus(item,menus)\r\n        menu.child.push(item)\r\n      } else if(item.menuType == 1) {\r\n        menu.child.push(item)\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\nfunction filterRoutes(menus) {\r\n  var routes = []\r\n  var root = {\r\n    path: \"\",\r\n    name: 'main',\r\n    component: () => import(`@/views/layout/index`),\r\n    redirect: '',\r\n    children: []\r\n  }\r\n  var children = []\r\n  //遍历出路由\r\n  menus.forEach(item => {\r\n    //把菜单先遍历出来\r\n    if(item.menuType == 1) {\r\n      var param = {\r\n        path: item.routeUrl,\r\n        name: item.menuName,\r\n        component: loadView(item.componentUrl),\r\n        props: JSON.stringify(item.param),\r\n      }\r\n      if(item.target == 1) {\r\n        children.push(param)\r\n      }\r\n      if(item.target == 0) {\r\n        routes.push(param)\r\n      }\r\n    }\r\n  });\r\n  root.children = children\r\n  if(children.length > 0) {\r\n    root.redirect = children[0].routeUrl\r\n  }\r\n  routes.push(root)\r\n  return routes;\r\n}\r\n\r\nfunction loadView(view){\r\n  if (process.env.NODE_ENV === 'development') {\r\n    return (resolve) => require([`@/views${view}`], resolve)\r\n  } else {\r\n    // 使用 import 实现生产环境的路由懒加载\r\n    return () => import(`@/views${view}`)\r\n  }\r\n}\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  getters,\r\n  mutations,\r\n  actions\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}